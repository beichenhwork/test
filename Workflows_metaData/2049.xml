<?xml version="1.0" encoding="UTF-8"?><workflow uri="http://www.myexperiment.org/workflow.xml?id=2049" resource="http://www.myexperiment.org/workflows/2049" id="2049" version="1">  <id>2049</id>  <title>Automated BrainSuite Cortical Surface Extraction Pipeline</title>  <description>&lt;h3&gt;Overview - &lt;a href="http://www.loni.ucla.edu/twiki/bin/view/CCB/BrainSuite" class="twikiLink"&gt;BrainSuite&lt;/a&gt; Cortical Surface Extraction&lt;/h3&gt;&#13;&lt;p&gt;The workflow takes a skull stripped volume as input and runs a  multi-stage process, extracting the cortical surface and splitting it  into hemispheres.&lt;/p&gt;&#13;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&#13;&lt;h3&gt;&lt;a name="Problem_addressed_by_this_workfl"&gt; &lt;/a&gt; Problem addressed by this workflow&lt;/h3&gt;&#13;&lt;p&gt;Generating a shape model of the cortical surface from a 3D volume.&lt;/p&gt;&#13;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&#13;&lt;h3&gt;&lt;a name="Detailed_Workflow_Usage_Specific"&gt; &lt;/a&gt; Detailed Workflow Usage &amp;amp; Specifications&lt;/h3&gt;&#13;&lt;p&gt;&lt;strong&gt;Tissue Classification&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;The next step in the Brainsuite09 cortical surface identification  sequence is tissue classification. This is performed by the Partial  Volume Classifier (PVC). This process assigns an integer tissue label to  each voxel in the image. These labels correspond to the type of tissue  that is estimated to be in that voxel. PVC accounts for background  voxels, cerebrospinal fluid, grey matter, and white matter. It also  labels voxels that are composed of combinations of these voxels. The  labels used are listed in Table PVC1. PVC can generate labelings with  the six tissue classes or with a simpler 3 class tissue output.&lt;/p&gt;&#13;&lt;p&gt;The PVC algorithm uses the partial volume measurement model that was  used for the bias field correction. However, it removes the spatially  varying gain component since that is assumed to have been corrected by  BFC. It does, however, include a spatial structural prior. This prior  models the brain as a set of piecewise continuous regions of single  tissue types, bounded by partial volume combinations. The prior  encourages neighborhoods of voxels to be similar. The influence of this  prior is controlled by the Spatial Prior.&lt;/p&gt;&#13;&lt;p&gt;Important: PVC should only be applied to skull-stripped brain images.&lt;/p&gt;&#13;&lt;p&gt;Note that the models used in PVC assume that only voxels containing CSF,  GM, and WM remain in the image. Thus, you should always skull-strip  your images before applying PVC.&lt;/p&gt;&#13;&lt;p&gt;&lt;strong&gt;Cerebrum Labeling&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;Once the brain volume has been extracted and classified, we need to  separate it into cerebellum, cerebrum, and other structures so that we  can identify the cerebral cortex. To achieve this, we apply a volumetric  registration (AIR, Woods et al., 1998) to align a labeled atlas to the  brain volume.&lt;/p&gt;&#13;&lt;p&gt;The Cerebrum labeler assumes that your brain volume is oriented into LPI  (-x points left / -y points posterior/-z points inferior) coordinates  (see front matter for a description of the coordinate system).&lt;/p&gt;&#13;&lt;p&gt;&lt;strong&gt;Cortex mask identification&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;Once the cerebrum, cerebellum, and brainstem have been labeled, we can  extract the cerebral cortex using the cortical modeling tool. The  default parameters, as shown, will select the white/grey boundary of the  cerebrum. Additionally, you can control the tissue fraction used in the  boundary decision. For example, using the 5% default, Brainsuite will  select the boundary corresponding to at least 5% white matter in each  voxel. This is combined with information from the atlas to produce a  cerebral mask.&lt;/p&gt;&#13;&lt;p&gt;&lt;strong&gt;Mask Scrubbing Tool&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;The mask scrubbing tool removes small surface pits and bumps by  examining voxel connectivity. With each iteration, it computes how many  foreground voxels each foreground voxel has as a neighbor. If the  threshold is not met, the foreground voxel becomes a background voxel. A  similar process is applied to the background voxels.&lt;/p&gt;&#13;&lt;p&gt;&lt;strong&gt;Topology Correction&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;To be able to map the surface of your extracted cortical volume using 2D  coordinates, the outer boundary must have spherical topology. The  Topological Correction Algorithm (TCA) will make corrections to your  volume to ensure this property. You can specify the minimum and maximum correction sizes to use. &lt;a href="http://www.loni.ucla.edu/twiki/bin/view/CCB/BrainSuite" class="twikiLink"&gt;BrainSuite&lt;/a&gt;  will begin by making its corrections using the minimum correction size  as its upper limit, then iterate until it reaches the maximum correction  speciied. This allows you to limit the size of individual change that  has to be made to the volume to fix its topology.&lt;/p&gt;&#13;&lt;p&gt;&lt;strong&gt;Wisp Removal&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;The Wisp Removal tool removes thin, wispy structures that are likely to  represent segmentation errors in the extraction process. It works by  decomposing the binary mask into a graph, and separating weakly  connected components. You can adjust the threshold used to break the  wisps and the maximum number of iterations applied. This process should  only take a few seconds.&lt;/p&gt;&#13;&lt;p&gt;&lt;strong&gt;Surface generation&lt;/strong&gt;&lt;/p&gt;&#13;&lt;p&gt;The surface model generation consists of 3 steps.&lt;/p&gt;&#13;&lt;p&gt;Generation. This step produces an initial mesh surface from the cortex  model produced in Stage 6. Split. This step will separate the initial cortical surface into left  and right hemispheres, based on the labeling produced during the  cerebrum labeling procedure. Parameterize. This step will induce a 2D coordinate system on each  hemisphere by mapping them to the unit square.&lt;/p&gt;&#13;&lt;p&gt;URL: http://www.loni.ucla.edu/twiki/bin/view/CCB/PipelineWorkflows_BrainSuiteCorticalSurfaceExtraction&lt;/p&gt;</description>  <type resource="http://www.myexperiment.org/content_types/83" uri="http://www.myexperiment.org/type.xml?id=83" id="83">LONI Pipeline</type>  <uploader resource="http://www.myexperiment.org/users/15656" uri="http://www.myexperiment.org/user.xml?id=15656" id="15656">Pipeline</uploader>  <created-at>2011-04-06 01:44:44 UTC</created-at>  <preview>http://www.myexperiment.org/workflows/2049/versions/1/previews/full</preview>  <svg>http://www.myexperiment.org/workflows/2049/versions/1/previews/svg</svg>  <license-type resource="http://www.myexperiment.org/licenses/2" uri="http://www.myexperiment.org/license.xml?id=2" id="2">by-sa</license-type>  <content-uri>https://myexperiment.org/workflows/2049/download/Automated_BrainSuite_Cortical_Surface_Extraction_Pipeline-v.pipe</content-uri>  <content-type>application/octet-stream</content-type>  <tags>    <tag uri="http://www.myexperiment.org/tag.xml?id=2527" resource="http://www.myexperiment.org/tags/2527" id="2527">brainsuite</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=2518" resource="http://www.myexperiment.org/tags/2518" id="2518">brain mapping</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=2523" resource="http://www.myexperiment.org/tags/2523" id="2523">imaging</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=2509" resource="http://www.myexperiment.org/tags/2509" id="2509">cortex</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=1532" resource="http://www.myexperiment.org/tags/1532" id="1532">surface</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=2498" resource="http://www.myexperiment.org/tags/2498" id="2498">shape</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=1638" resource="http://www.myexperiment.org/tags/1638" id="1638">extraction</tag>    <tag uri="http://www.myexperiment.org/tag.xml?id=2503" resource="http://www.myexperiment.org/tags/2503" id="2503">automated</tag>  </tags></workflow>