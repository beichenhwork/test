<?xml version="1.0" encoding="UTF-8"?><workflow uri="http://www.myexperiment.org/workflow.xml?id=5147" resource="http://www.myexperiment.org/workflows/5147" id="5147" version="1">  <id>5147</id>  <title>cutadapt+BWA-MEM-mis1-i2,2-gapex2,2+filter_c5.0_c4.15+idxStats</title>  <description>&lt;p&gt;This workflow is designed to genotype trinucleotide repeats from sequencing reads that span the repeat and its flanks&lt;/p&gt;&lt;p&gt;Detailed description as follows:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;1. Input fastq sequencing reads files&lt;/strong&gt; (Galaxy tool: Input dataset)&lt;/p&gt;&lt;p&gt;Input files for the workflow are single-end MiSeq reads (R1 produced using the protocol from &lt;a href="https://protocolexchange.researchsquare.com/article/nprot-6621/v2"&gt;Ciosi et al. 2018&lt;/a&gt;) or PacBio reads of insert (ROI) in fastq files format.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;2. Removing Illumina sequencing adaptor sequence in 3&amp;rsquo; of the MiSeq reads&lt;/strong&gt; (Galaxy tool: Cutadapt 1.16)&lt;/p&gt;&lt;p&gt;Cutadapt removes the sequencing adaptor sequence from the 3&amp;rsquo; end (custom 3&amp;#39; adapter sequence used: GATCGGAAGAGCACACGTCTGAACTCCAGTCAC) of the forward reads (R1 produced using the protocol from &lt;a href="https://protocolexchange.researchsquare.com/article/nprot-6621/v2"&gt;Ciosi et al. 2018&lt;/a&gt;) allowing a maximum error rate of 0.39.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;2&amp;rsquo;. QC of sequencing adaptor removal&lt;/strong&gt; (Galaxy tool: FastQC version 0.71)&lt;/p&gt;&lt;p&gt;Carried out using FastQC after removing the sequencing adaptor to check that it has happened as expected&lt;/p&gt;&lt;p&gt;&lt;strong&gt;3. Input the fasta file containing the synthetic reference sequence(s) for BWA-MEM alignment&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Multiple synthetic reference sequences containing different number of repeats are typically used (typically variable number of CAG and/or CCG repeats to genotype the &lt;em&gt;HTT&lt;/em&gt; exon one trinucleotide repeat)&lt;/p&gt;&lt;p&gt;&lt;strong&gt;3&amp;rsquo;. BWA-MEM aligns reads to one or more reference sequences &lt;/strong&gt;(Galaxy tool: Map with BWA-MEM version 0.7.17.1)&lt;/p&gt;&lt;p&gt;For MiSeq reads BWA-MEM parameters are kept as default except the following to make gap-related cost higher than mismatch-related costs:&lt;/p&gt;&lt;p&gt;Penalty for mismatch: 1&lt;/p&gt;&lt;p&gt;Gap open penalties for deletions and insertions: 2,2&lt;/p&gt;&lt;p&gt;Gap extension penalties: 2,2&lt;/p&gt;&lt;p&gt;&lt;strong&gt;4. BAM converted to SAM&lt;/strong&gt; (Galaxy tool: BAM-to-SAM version 2.0.1)&lt;/p&gt;&lt;p&gt;Alignment output BAM files are converted to SAM format using BAM-to-SAM.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;5. Reads are filtered out from the SAM file&lt;/strong&gt; (Galaxy tool: Filter version 1.1.0)&lt;/p&gt;&lt;p&gt;Reads with a MAPQ score of 0 (obtained for reads aligned equally well to &amp;gt;1 reference sequence) and/or reads associated with an alignment that did not start in the sequence flanking the CAG repeat in 5&amp;rsquo; (probably only relevant if reads have been generated by PCR and the 5&amp;rsquo; end of the reference sequence corresponds to the PCR primer used to amplify the locus sequenced) are filtered out of the SAM file [filtering criteria used were c5&amp;gt;0 and c4&amp;lt;15 for &lt;em&gt;HTT&lt;/em&gt; repeat reads generated with the forward PCR primers 31329 (5&amp;rsquo;- ATGAAGGCCTTCGAGTCCCTCAAGTCCTTC-3&amp;rsquo;) and c5&amp;gt;0 and c4&amp;lt;130 for &lt;em&gt;HTT&lt;/em&gt; repeat reads generated with the forward PCR primers MS1F (5&amp;rsquo;-GCCCAGAGCCCCATTCATTG-3&amp;rsquo;); c5 for MAPQ and c4 for the position of the start of the alignment relatively to the reference sequence]. Number of header lines to skip = (number of reference sequences considered for the alignment) + 2&lt;/p&gt;&lt;p&gt;&lt;strong&gt;5&amp;rsquo;. QC of read filtering from SAM&lt;/strong&gt; (Galaxy tool: FastQC version 0.71)&lt;/p&gt;&lt;p&gt;Carried out using FastQC after filtering out some reads from the SAM file to check that it has happened as expected&lt;/p&gt;&lt;p&gt;&lt;strong&gt;6. Generate an alignment report table from the SAM file&lt;/strong&gt; (Galaxy tool: IdxStats version 2.0.1)&lt;/p&gt;&lt;p&gt;IdxStats is ran on each alignment SAM file to generate an alignment report table&lt;/p&gt;&lt;p&gt;&lt;strong&gt;7. Columns of the IdxStats alignment report table are removed to only keep the columns that contain the reference sequence identifier and the number of reads aligned to each of these reference sequences&lt;/strong&gt; (Galaxy tool: Cut columns from a table version 1.0.2).&lt;/p&gt;&lt;p&gt;Removes column 1 and 3 from the initial IdxStats output.&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Visible output files produced by the workflow:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;two FastQC read quality reports (txt and html) post-cutadapt (output of step 2&amp;rsquo;)&lt;/p&gt;&lt;p&gt;a sam file of aligned reads for visualising repeat genotypes (output of step 4)&amp;nbsp;&lt;/p&gt;&lt;p&gt;one FastQC read quality report (txt) post-filtering of SAM file (output of step 5&amp;rsquo;)&lt;/p&gt;&lt;p&gt;two tab-delimited files with the number of reads aligned to each synthetic reference sequence considered for the alignment (output steps 7 and 8)&lt;/p&gt;</description>  <type resource="http://www.myexperiment.org/content_types/73" uri="http://www.myexperiment.org/type.xml?id=73" id="73">Galaxy</type>  <uploader resource="http://www.myexperiment.org/users/66146" uri="http://www.myexperiment.org/user.xml?id=66146" id="66146">Marc Ciosi</uploader>  <created-at>2020-06-01 22:02:22 UTC</created-at>  <preview>http://www.myexperiment.org/workflows/5147/versions/1/previews/full</preview>  <svg>http://www.myexperiment.org/workflows/5147/versions/1/previews/svg</svg>  <license-type/>  <content-uri>https://myexperiment.org/workflows/5147/download/cutadapt_BWA-MEM-mis1-i2_2-gapex2_2_filter_c5.0_c4.15_idxStats-v.ga</content-uri>  <content-type>application/vnd.galaxy.workflow+json</content-type>  <tags/></workflow>